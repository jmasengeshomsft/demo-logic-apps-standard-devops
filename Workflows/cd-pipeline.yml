trigger: none

resources:
  pipelines:
  - pipeline: build
    source: 'Workflows - Build'

variables:
  azureSubscription: 'Demo Account'
  azureSubscriptionId: '164a84cf-b099-4567-a527-c2a8143a32c7'
  region: 'eastus'
  logicAppName: 'logic-rutzsco-demo-logic-app-ci'
  
stages:
- stage: CI
  displayName: 'CI'
  jobs:
  - deployment: Deploy
    displayName: Deploy
    pool:
      vmImage: ubuntu-latest
    environment: LA-CI
    strategy:
      runOnce:
        deploy:
          steps:
          - task: AzureFunctionApp@1
            displayName: 'Deploy logic app workflows'
            inputs:
              azureSubscription: '$(azureSubscription)'
              appType: 'functionApp'
              appName: '$(logicAppName)'
              package: '$(Pipeline.Workspace)/build/App/LA.zip'
              deploymentMethod: 'zipDeploy'
              AppSettings: '-WORKFLOWS_SUBSCRIPTION_ID $(azureSubscriptionId) -WORKFLOWS_LOCATION_NAME $(region)'
